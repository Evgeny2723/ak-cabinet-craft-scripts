function initApp(){var reviewsSwiper=new Swiper(".reviews-swiper",{slidesPerView:1,centeredSlides:!0,spaceBetween:8,navigation:{nextEl:".btn-next",prevEl:".btn-prev",},breakpoints:{767:{slidesPerView:"auto",centeredSlides:!0,spaceBetween:16}}});var testimonialsSwiper=new Swiper(".testimonials-swiper",{slidesPerView:1,centeredSlides:!0,spaceBetween:8,navigation:{nextEl:".btn-next",prevEl:".btn-prev",},breakpoints:{767:{slidesPerView:2,centeredSlides:!1,spaceBetween:16}},pagination:{el:".swiper-pagination",}});var advantagesSwiper=new Swiper(".advantages-swiper",{slidesPerView:1,centeredSlides:!0,spaceBetween:8,navigation:{nextEl:".btn-next",prevEl:".btn-prev",},breakpoints:{767:{slidesPerView:"auto",centeredSlides:!1,spaceBetween:16}}});let mm=gsap.matchMedia();const processCards=gsap.utils.toArray('.process-card');if(processCards.length>0){const perCard=window.innerHeight;const total=perCard*(processCards.length+1);mm.add({isDesktop:"(min-width: 768px)",isMobile:"(max-width: 767px)"},(context)=>{let{isDesktop}=context.conditions;const tl=gsap.timeline({scrollTrigger:{trigger:'.section-process',start:isDesktop?'top -85px':'top -20px',end:()=>`+=${total}`,pin:'.progress-sticky',scrub:!0,}});processCards.forEach((card,i)=>{const finalScale=0.8+i*0.02;const ladderOffset=(i*5)-6;tl.fromTo(card,{y:'100vh',scale:1.1},{y:`${ladderOffset}vh`,scale:finalScale,ease:'none',duration:1},i*1)});tl.to(processCards,{y:'-100vh',scale:0,ease:'power2.in',duration:1,stagger:0.1},processCards.length);return()=>{tl.kill()}})}
document.querySelectorAll("[data-split-heading]").forEach(el=>{const split=new SplitText(el,{type:"words"});const tl=gsap.timeline({scrollTrigger:{trigger:el,start:"top 85%",toggleActions:"play none none none"}});tl.from(split.words,{duration:0.8,yPercent:50,autoAlpha:0,ease:"power1.out",stagger:0.06})});document.querySelectorAll("[data-split-p]").forEach(el=>{const splitP=new SplitText(el,{type:"lines"});const tl=gsap.timeline({scrollTrigger:{trigger:el,start:"top 85%",toggleActions:"play none none none"}});tl.from(splitP.lines,{duration:0.6,yPercent:100,autoAlpha:0,ease:"power1.inOut",stagger:0.1,delay:0.4})});const qualitySection=document.querySelector('.section-quality');if(qualitySection){const wrappers=[...qualitySection.querySelectorAll('.quality-image-w')];const images=[...qualitySection.querySelectorAll('.quality-image')];const items=[...qualitySection.querySelectorAll('.quality-list__item')];const texts=[...qualitySection.querySelectorAll('.quality-content__text')];const lines=[...qualitySection.querySelectorAll('.quality-list__item-line')];const bgImages=[...qualitySection.querySelectorAll('.quality-list__item-img')];const count=items.length;const step=window.innerHeight;const addActive=i=>{items[i].classList.add('is-active');wrappers[i].classList.add('is-active');texts[i].classList.add('is-active');bgImages[i].classList.add('is-active')};const removeActive=i=>{items[i].classList.remove('is-active');wrappers[i].classList.remove('is-active');texts[i].classList.remove('is-active');bgImages[i].classList.remove('is-active');if(lines[i])lines[i].style.width='0%'};if(items.length>0)addActive(0);wrappers.forEach((wrapper,i)=>{const start=i*step;const end=start+step;gsap.set(images[i],{scale:1.2});gsap.to(images[i],{scale:1,ease:'power1.inOut',scrollTrigger:{trigger:qualitySection,start:`${start}px top`,end:`${end}px top`,scrub:!0}});ScrollTrigger.create({trigger:qualitySection,start:`${start}px top`,end:`${end}px top`,scrub:!0,onEnter:()=>addActive(i),onEnterBack:()=>addActive(i),onLeave:()=>{if(i<count-1)removeActive(i)},onLeaveBack:()=>{if(i>0)removeActive(i)}});ScrollTrigger.create({trigger:qualitySection,start:`${start}px top`,end:`${end}px top`,scrub:!0,onUpdate:self=>{lines.forEach((ln,j)=>{if(j===i){ln.style.opacity=1;ln.style.width=`${self.progress * 100}%`}else{ln.style.opacity=0;ln.style.width='0%'}})}})})}
document.querySelectorAll(".project-item").forEach(item=>{const img=item.querySelector(".project-item__image");const itemShift=gsap.utils.random(-120,-60);const imgShift=gsap.utils.random(40,80);gsap.to(item,{y:itemShift,ease:"none",scrollTrigger:{trigger:item,start:"top bottom",end:"bottom top",scrub:!0}});gsap.to(img,{y:imgShift,ease:"none",scrollTrigger:{trigger:item,start:"top bottom",end:"bottom top",scrub:!0}})});const nav=document.querySelector('.navbar');const navCorp=document.querySelector('.navbar-corp');const touchbarMobile=document.querySelector('.touchbar-mobile');if(nav||navCorp){const invertedNavPages=['/portfolio','/contact','/blog','/privacy-policy','/posts','/thank-you','/quiz'];const currentPath=window.location.pathname;const triggerSelectors=['.section-hero','.project-temaplate-hero','.hero-cms-template','.shaker-hero'];const needsInversion=invertedNavPages.some(pagePrefix=>currentPath.startsWith(pagePrefix));if(needsInversion){if(navCorp)navCorp.classList.add('inverted-c');}else{if(touchbarMobile){gsap.set(touchbarMobile,{yPercent:100})}
triggerSelectors.forEach(selector=>{const triggerElement=document.querySelector(selector);if(triggerElement){ScrollTrigger.create({trigger:triggerElement,start:'bottom top',onEnter:()=>{if(nav)nav.classList.add('inverted');if(navCorp)navCorp.classList.add('inverted-c');if(touchbarMobile){gsap.to(touchbarMobile,{yPercent:0,duration:0.4,ease:'power2.out'})}},onLeaveBack:()=>{if(nav)nav.classList.remove('inverted');if(navCorp)navCorp.classList.remove('inverted-c');if(touchbarMobile){gsap.to(touchbarMobile,{yPercent:100,duration:0.4,ease:'power2.in'})}}})}})}}
if(nav||navCorp){const hideTriggers=['.section-cta','.contacts-hero','.cta-black'];hideTriggers.forEach(triggerClass=>{if(document.querySelector(triggerClass)){ScrollTrigger.create({trigger:triggerClass,start:'bottom 15%',onEnter:()=>{if(nav)nav.classList.add('navbar-hidden');if(navCorp)navCorp.classList.add('navbar-hidden');if(touchbarMobile){gsap.to(touchbarMobile,{yPercent:100,duration:0.4,ease:'power2.in'})}},onLeaveBack:()=>{if(nav)nav.classList.remove('navbar-hidden');if(navCorp)navCorp.classList.remove('navbar-hidden');if(touchbarMobile){gsap.to(touchbarMobile,{yPercent:0,duration:0.4,ease:'power2.out'})}}})}})}
const btn=document.querySelector('.navbar-button');const menu=document.querySelector('.navbar-menu');if(btn&&menu){const links=menu.querySelector('.menu-links');const contacts=menu.querySelector('.navbar-contacts');const contactsTitle=document.querySelectorAll('.navbar-contacts__title');let isOpen=!1;btn.addEventListener('click',()=>{const tl=gsap.timeline({defaults:{ease:'power3.out'}});const newText=isOpen?'Menu':'Close';if(!isOpen){isOpen=!0;if(nav)nav.classList.add('menu-open');if(navCorp)navCorp.classList.add('menu-open');tl.to(menu,{height:'100vh',duration:1}).to([links,contacts,contactsTitle],{opacity:1,scale:1,duration:0.2,},'<').to(btn,{opacity:0,duration:0.5},0).add(()=>btn.textContent=newText,0.3).to(btn,{opacity:1,duration:0.5},0.3)}else{isOpen=!1;if(nav)nav.classList.remove('menu-open');if(navCorp)navCorp.classList.remove('menu-open');tl.to([links,contacts,contactsTitle],{opacity:0,scale:0.98,duration:0.2,}).to(menu,{height:'0vh',duration:1},'<').to(btn,{opacity:0,duration:0.5},0).add(()=>btn.textContent=newText,0.3).to(btn,{opacity:1,duration:0.5},0.3)}});menu.querySelectorAll('a').forEach(link=>{link.addEventListener('click',()=>{if(isOpen){btn.click()}})})}
const textAnimWrappers=gsap.utils.toArray('.hero-label__texts');textAnimWrappers.forEach(wrapper=>{const texts=wrapper.querySelectorAll('.hero-label__text');if(texts.length>0){gsap.set(texts,{autoAlpha:0,y:'100%'});function startMainLoop(){const loopTl=gsap.timeline({repeat:-1});texts.forEach((text,index)=>{const currentText=texts[index];const nextText=texts[(index+1)%texts.length];loopTl.to({},{duration:2}).to(currentText,{autoAlpha:0,y:'-100%',duration:0.5,ease:'power2.inOut'}).fromTo(nextText,{y:'100%'},{autoAlpha:1,y:'0%',duration:0.5,ease:'power2.inOut',immediateRender:!1},'<')})}
const introTl=gsap.timeline({onComplete:startMainLoop});introTl.to(texts[0],{autoAlpha:1,y:'0%',duration:0.5,ease:'power2.out'})}});$.validator.addMethod("phoneUS_complete",function(value,element){return this.optional(element)||(element.imask&&element.imask.masked.isComplete)},"Please enter a complete phone number.");$.validator.addMethod("email_strict",function(value,element){return this.optional(element)||/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(value)},"Please enter the correct email address.");$("#cta-form, #lp-target-form").validate({rules:{fullname:{required:!0},phone:{required:!0,phoneUS_complete:!0},email:{required:!0,email:!0},address:{required:!0},time:{required:!0}},messages:{email:{email:"Invalid email"}},errorPlacement:function(error,element){error.appendTo(element.closest(".input-wrapper"))},highlight:function(element){$(element).css("border-bottom","1px solid var(--error)")},unhighlight:function(element){$(element).css("border-bottom","1px solid var(--white)")},});$("#corp-cta-form").validate({rules:{firstname:{required:!0},lastname:{required:!0},phone:{required:!0,phoneUS_complete:!0},email:{required:!0,email_strict:!0},address:{required:!0},'project-type':{required:!0},time:{required:!0}},messages:{email:{email:"Invalid email"},'project-type':{required:"Please select a project type from the list to proceed."}},errorPlacement:function(error,element){error.appendTo(element.closest(".input-wrapper"))},highlight:function(element){$(element).css("background-color","rgba(200, 15, 15, 0.06)").addClass("error-placeholder")},unhighlight:function(element){$(element).css("background-color","").removeClass("error-placeholder")},});$("#new-cta-form").validate({rules:{firstname:{required:!0},lastname:{required:!0},phone:{required:!0,phoneUS_complete:!0},email:{required:!0,email_strict:!0},address:{required:!0},'project-type':{required:!0},time:{required:!0}},messages:{email:{email:"Invalid email"},'project-type':{required:"Please select a project type from the list to proceed."}},errorPlacement:function(error,element){error.appendTo(element.closest(".input-wrapper"))},highlight:function(element){$(element).css("background-color","var(--white)").addClass("error-placeholder")},unhighlight:function(element){$(element).css("background-color","").removeClass("error-placeholder")},});$("#direct-form").validate({rules:{name:{required:!0},phone:{required:!0,phoneUS_complete:!0},email:{required:!0,email_strict:!0},address:{required:!0},time:{required:!0}},messages:{email:{email:"Invalid email"}},errorPlacement:function(error,element){error.appendTo(element.closest(".input-wrapper"))},highlight:function(element){$(element).css("border","1px solid var(--error)").addClass("error-placeholder")},unhighlight:function(element){$(element).css("border","").removeClass("error-placeholder")},});$("#price-form").validate({rules:{'p-name':{required:!0},'p-phone':{required:!0,phoneUS_complete:!0},'p-address':{required:!0},'p-email':{required:!0,email_strict:!0},'p-time':{required:!0}},messages:{'p-email':{email:"Invalid email"}},errorPlacement:function(error,element){error.appendTo(element.closest(".input-wrapper"))},highlight:function(element){$(element).css("border","1px solid var(--error)").addClass("error-placeholder")},unhighlight:function(element){$(element).css("border","").removeClass("error-placeholder")},});const phoneInputs=document.querySelectorAll('input[name="phone"], input[name="p-phone"]');if(phoneInputs.length>0){const phoneMaskOptions={mask:'+1 ({N}00) 000-0000',lazy:!1,blocks:{N:{mask:IMask.MaskedRange,from:2,to:9},'0':{mask:IMask.MaskedRange,from:0,to:9}}};phoneInputs.forEach(function(inputElement){inputElement.imask=IMask(inputElement,phoneMaskOptions)})}
$('#cta-form, #corp-cta-form, #new-cta-form, #lp-target-form, #direct-form, #price-form').each(function(){const formElement=$(this);const formBlock=formElement.closest('.w-form');const nativeSuccessMessage=formBlock.find('.w-form-done');if(nativeSuccessMessage.length>0){const observer=new MutationObserver(function(mutations){mutations.forEach(function(mutation){if(mutation.attributeName==="style"&&nativeSuccessMessage.is(':visible')){window.location.href='/thank-you';observer.disconnect()}})});observer.observe(nativeSuccessMessage[0],{attributes:!0})}});const filterBlock=document.querySelector('.portfolio-filter');function updateFilterHeight(){if(navCorp&&filterBlock){filterBlock.style.height=`calc(100vh - ${navCorp.offsetHeight}px)`}}
updateFilterHeight();window.addEventListener('resize',updateFilterHeight);document.querySelectorAll('.gallery-item').forEach((item,index)=>{if(index%3===0){item.classList.add('is-large')}});document.querySelectorAll('[ms-code-submit-new]').forEach(button=>{button.addEventListener('click',function(e){e.preventDefault();const submitId=this.getAttribute('ms-code-submit-new');const oldSubmitButton=document.querySelector(`[ms-code-submit-old="${submitId}"]`);if(oldSubmitButton){oldSubmitButton.click()}else{console.error(`No matching old submit button found for ID: ${submitId}`)}})})}
function waitForJquery(){if(typeof $!=='undefined'){initApp()}else{setTimeout(waitForJquery,50)}}
waitForJquery();function waitForSbjs(){if(typeof sbjs!=='undefined'){try{console.log("Sourcebuster (sbjs) загружен. Инициализирую.");sbjs.init();if(sbjs.get.current.src){const utmSourceValue=sbjs.get.current.src;$('input[name="utmSource"]').val(utmSourceValue)}}catch(e){console.error("Ошибка при инициализации sbjs:",e)}}else{setTimeout(waitForSbjs,50)}}
waitForSbjs()
